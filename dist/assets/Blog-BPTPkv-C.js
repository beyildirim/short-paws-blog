import{b as w,p as E,d as C,n as f,i as j,h as y,r as c,j as e,X as T,u as k,H as z,B as H,L as _}from"./index-BF3VccOc.js";import{d as A,i as L,f as P}from"./blogStore-tYdPdNxU.js";import{S as B}from"./search-CkD0c_qf.js";import{u as I,C as M,a as R,b as F}from"./usePosts-BaYi5LWd.js";const O={},N=()=>{if(typeof import.meta<"u"&&"env"in import.meta)return O.VITE_NEWSLETTER_ENDPOINT},$=w()(E((t,a)=>({subscribers:[],subscribe:async l=>{const r=f(l),{subscribers:u}=a(),n=N();if(!j(r))return{success:!1,message:"Please enter a valid email address"};if(n)try{return(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})})).ok?{success:!0,message:"Successfully subscribed! ðŸŽ‰"}:{success:!1,message:"Subscription failed. Please try again."}}catch(o){return console.error("Newsletter subscription error:",o),{success:!1,message:"Subscription failed. Please try again."}}const d=await y(r);return u.some(o=>o.emailHash===d)?{success:!1,message:"This email is already subscribed!"}:(t({subscribers:[...u,{emailHash:d,subscribedAt:new Date().toISOString()}]}),{success:!0,message:"Successfully subscribed! ðŸŽ‰"})},isSubscribed:async l=>{const r=f(l);if(!j(r)||N())return!1;const n=await y(r);return a().subscribers.some(d=>d.emailHash===n)}}),{name:C.NEWSLETTER,version:1,migrate:t=>{if(!t||typeof t!="object")return t;const a=t;return Array.isArray(a.subscribers)?a.subscribers.every(r=>typeof r.emailHash=="string"&&r.emailHash.length>0)?a:{...a,subscribers:[]}:t}}));function D({onSearch:t,placeholder:a="Search blog posts..."}){const[l,r]=c.useState(""),[u,n]=c.useState(!1),d=A(m=>{t(m)},300),o=m=>{const p=m.target.value;r(p),d(p)},x=()=>{r(""),t("")};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`
          relative flex items-center border-2 rounded-lg transition-all duration-300
          ${u?"border-purple-500 shadow-md":"border-purple-300 hover:border-purple-400"}
        `,children:[e.jsx(B,{className:"absolute left-3 text-gray-400",size:20}),e.jsx("input",{type:"text",value:l,onChange:o,onFocus:()=>n(!0),onBlur:()=>n(!1),placeholder:a,className:"w-full pl-10 pr-10 py-2 rounded-lg focus:outline-none","aria-label":"Search blog posts"}),l&&e.jsx("button",{onClick:x,className:"absolute right-3 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Clear search",children:e.jsx(T,{size:20})})]}),l&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Searching for: ",e.jsx("span",{className:"font-medium text-purple-600",children:l})]})]})}function G({tags:t,activeTag:a,onChange:l}){return t.length===0?null:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>l(null),className:`px-3 py-1 rounded-full text-sm border transition-colors ${a===null?"bg-purple-600 text-white border-purple-600":"bg-white text-purple-600 border-purple-300 hover:border-purple-500"}`,children:"All"}),t.map(r=>e.jsxs("button",{onClick:()=>l(r),className:`px-3 py-1 rounded-full text-sm border transition-colors ${a===r?"bg-purple-600 text-white border-purple-600":"bg-white text-purple-600 border-purple-300 hover:border-purple-500"}`,children:["#",r]},r))]})}function W(){const t=I(),{subscribe:a}=$(),{settings:l}=k(),[r,u]=c.useState(""),[n,d]=c.useState(null),[o,x]=c.useState(""),[m,p]=c.useState(null),v=c.useMemo(()=>Array.from(new Set(t.flatMap(s=>s.tags))).sort(),[t]),g=c.useMemo(()=>{if(!r.trim())return t;const s=r.toLowerCase();return t.filter(i=>i.title.toLowerCase().includes(s)||i.excerpt.toLowerCase().includes(s)||i.content.toLowerCase().includes(s)||i.tags.some(b=>b.toLowerCase().includes(s)))},[t,r]),h=c.useMemo(()=>n?g.filter(s=>s.tags.includes(n)):g,[g,n]),S=async s=>{s.preventDefault();const i=await a(o);p({message:i.message,isError:!i.success}),i.success&&x(""),setTimeout(()=>p(null),5e3)};return e.jsxs(e.Fragment,{children:[e.jsxs(z,{children:[e.jsxs("title",{children:["Blog | ",l.title]}),e.jsx("meta",{name:"description",content:"Read the latest insights from Gizmeli Kedi on planning, strategy, and professional development"})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white border-4 border-pink-500 rounded-lg p-8 shadow-lg",children:[e.jsxs("h2",{className:"text-3xl font-bold text-purple-600 mb-6 text-center flex items-center justify-center gap-2",children:[e.jsx(H,{className:"text-pink-500","aria-hidden":"true"}),"Gizmeli Kedi's Blog"]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx(D,{onSearch:u}),e.jsx(G,{tags:v,activeTag:n,onChange:d})]}),h.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"No posts found ðŸ˜¿"}),e.jsx("p",{className:"text-gray-500",children:"Try a different search term"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Showing ",h.length," ",h.length===1?"post":"posts"]}),e.jsx("div",{className:"grid gap-6",children:h.map(s=>{const i=L[s.icon];return e.jsxs("article",{className:"bg-pink-50 rounded-lg p-6 transition-transform duration-300 hover:transform hover:scale-[1.02] border-2 border-purple-200",children:[s.coverImage&&e.jsx("div",{className:"mb-4 overflow-hidden rounded-lg border-2 border-purple-200",children:e.jsx("img",{src:s.coverImage,alt:s.title,className:"w-full h-48 object-cover",loading:"lazy",decoding:"async"})}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-white p-3 rounded-full shadow-md",children:e.jsx(i,{className:"text-purple-500",size:24})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-600 mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(M,{size:16,"aria-hidden":"true"}),e.jsx("time",{dateTime:s.publishedAt,children:P(s.publishedAt)})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{size:16,"aria-hidden":"true"}),s.readTime]})]}),e.jsx("p",{className:"text-gray-700 mb-4",children:s.excerpt}),s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:s.tags.map(b=>e.jsxs("span",{className:"text-xs px-2 py-1 bg-white border border-purple-200 rounded-full text-purple-700",children:["#",b]},b))}),e.jsxs(_,{to:`/blog/${s.id}`,className:"inline-flex items-center text-purple-600 hover:text-purple-700 font-medium hover:underline",children:["Read More",e.jsx(F,{size:16,className:"ml-1","aria-hidden":"true"})]})]})]})]},s.id)})})]})]}),e.jsxs("div",{className:"bg-pink-100 border-4 border-purple-400 rounded-lg p-8 shadow-lg text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-600 mb-4",children:"Subscribe to My Newsletter"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Get the latest planning insights and cat wisdom delivered to your inbox!"}),e.jsxs("form",{onSubmit:S,className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",value:o,onChange:s=>x(s.target.value),placeholder:"Enter your email",className:"flex-grow px-4 py-2 rounded-md border-2 border-purple-300 focus:border-purple-500 focus:ring focus:ring-purple-200 focus:ring-opacity-50 focus:outline-none",required:!0,"aria-label":"Email address for newsletter"}),e.jsx("button",{type:"submit",className:"bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700 transition-colors duration-300",children:"Subscribe"})]}),m&&e.jsx("div",{className:`mt-4 p-3 rounded-lg ${m.isError?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:m.message})]})]})]})]})}export{W as default};
