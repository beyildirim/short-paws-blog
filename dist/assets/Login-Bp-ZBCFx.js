import{r as n,l as g,m as S,o as A,u as E,j as e,q as f,v as L,s as U,R as b}from"./index-Dq3VNshP.js";import{U as C}from"./user-B09hxlTM.js";function R(){const[l,h]=n.useState(g),[t,w]=n.useState(""),[d,v]=n.useState(""),[i,a]=n.useState(""),[c,u]=n.useState(!1),m=S(),p=A(r=>r.login),{settings:j,updateSettings:y}=E(),s=!j.adminPassword,N=async r=>{r.preventDefault(),a(""),u(!0);try{if(s){if(!t||!d){a("Please enter and confirm a new password");return}if(t!==d){a("Passwords do not match");return}const o=L(t);if(!o.valid){a(o.message||"Password does not meet requirements");return}const P=await U(t);y({adminPassword:P});const x=await p(g,t);x.success?m(b.ADMIN):a(x.error||"Unable to log in after setup")}else{if(!l.trim()||!t.trim()){a("Please enter both username and password");return}const o=await p(l.trim(),t);o.success?m(b.ADMIN):a(o.error||"Invalid username or password")}}catch(o){a("An error occurred. Please try again."),console.error("Login error:",o)}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-purple-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md border-4 border-pink-500",children:[e.jsx("h2",{className:"text-2xl font-bold text-center text-purple-600 mb-6",children:s?"Set Admin Password":"Admin Login"}),i&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:i}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[!s&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:l,onChange:r=>h(r.target.value),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter username"})]})]}),s&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 text-purple-700 px-4 py-3 rounded text-sm",children:["Admin username is ",e.jsx("span",{className:"font-semibold",children:"admin"}),". Set a password to continue."]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:s?"New Password":"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"password",value:t,onChange:r=>w(r.target.value),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:s?"Create a strong password":"Enter password"})]})]}),s&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"password",value:d,onChange:r=>v(r.target.value),className:"w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Re-enter password"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Minimum 10 characters with letters and numbers."})]}),e.jsx("button",{type:"submit",disabled:c,className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:c?s?"Saving...":"Logging in...":s?"Set Password":"Login"})]})]})})}export{R as default};
